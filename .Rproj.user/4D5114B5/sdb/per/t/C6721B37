{
    "contents" : "---\ntitle: 'Reproducible Research: Peer Assessment 1'\nauthor: \"Kumar Aiyer\"\ndate: \"Saturday, March 14, 2015\"\noutput: \n  html_document:\n    keep_md: true\n---\n\n## Executive Summary\n\nIn this report we explore how to analyze a typical fitness dataset with missing data. We introduce an algorithm to backfill missing data and then answer some key questions on activity for an entire day. Our analysis shows that the average number of total steps taken in a day is 10766 steps. The median (50th percentile) of the total number of steps taken in a day is 10765 steps. With the backfilled data, the mean of the total daily steps is 10766 and the median is also 10766. The mean is the same as the original data set and the median is higher by 1 compared to the original data set. Finally on a typical weekend day, a subject covered 12201 steps versus 10255 steps on a weekday, showing more active lifestyle on a typical weekend.\n\n## Loading and preprocessing the data\n\nWe load the data from the zip file and convert the dates to Posix time format. Next, we perform data cleaning and remove the rows having NA's for steps in the data frame.\n\n```{r, echo=TRUE}\n# loading libraries\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(lattice)\nlibrary(foreach)\n# load data\ndata <- read.table(unz(\"activity.zip\", \"activity.csv\"), nrows=17570, header=T, quote=\"\\\"\", sep=\",\")\ndata$date <- as.Date(data$date)\n\n# drop the NA's\ndata.df <- data[!is.na(data$steps),]\n# summary\nsummary(data)\nsummary(data.df)\n```\nThe summary on the two data sets shows that the NA's have been cleaned.\n\n\n## What is mean total number of steps taken per day?\n\nWe use the dplyr package to create an aggregation of steps over the period of an entire day by summing over all the 5 minute step intervals in a entire day for each date in the data set. We then plot a historgram to see the pattern of the distribution and the compute the mean and median of the distribution. We then use the summarise function to compute the mean and median number of daily steps for this data set. Our analysis shows that the average number of total steps taken in a day is 10766 steps. The median (50th percentile) of the total number of steps taken in a day is 10765 steps.\n\n```{r, echo=TRUE}\n# apply group_by and compute daily total steps\nby_date.df <- group_by(data.df, date)\nby_date.summary <- summarise(by_date.df, totsteps=sum(steps),nr=length(interval))\n# plot histogram of ata\nhist(by_date.summary$totsteps,main=\"Histogram of total daily steps\", xlab=\"total daily steps\", ylab=\"count\")\n# mean and median of daily total steps\nall_data.summary <- summarise(by_date.summary, mean.steps = mean(totsteps),median.steps=median(totsteps))\nall_data.summary\n```\n\n## What is the average daily activity pattern?\n\nWe now shift the focus to the average daily activity pattern. Instead of aggregating over the 5 minute intervals of a given day, we aggregate over all dates in the data set for each interval of the day. We then plot the time series. The 835th minute (or 168th 5-minute interval ) interval, on average across all the days in the dataset, contains the maximum number of steps of 206.\n\n```{r, echo=TRUE}\n# now create dataframe for daily activity pattern and plot it\nby_interval.df <- group_by(data.df, interval)\nby_interval.summary <- summarise(by_interval.df, mean.steps=mean(steps))\nplot(by_interval.summary$interval,by_interval.summary$mean.steps, type='l', main=\"steps vs intervals\", xlab= \"interval\" , ylab=\"mean steps\")\n# find the max value of steps during the day and then find the interval at which it occurs\nmaxsteps <- max(by_interval.summary$mean.steps)\nmaxsteps\nmaxinterval <- by_interval.summary[by_interval.summary$mean.steps==maxsteps,]$interval\nmaxinterval\nintervalnum <- maxinterval/5 + 1\nintervalnum\n```\n\n## Imputing missing values\n\nWe now shift our efforts to develop an algorithm to backfill the missing values in the data set. We find that there are 2304 missing values for step data in the dataset.\nThe simplest algorithm that will maintain the overall mean number of total steps for a day is to use the mean for each interval aggregated across dates to backfill the dataset. The mean of the total daily steps is 10766 and the median is also 10766. The mean is the same as the original data set and the median is higher by 1 compared to the original data set.\n\n```{r, echo=TRUE}\n# find number of NA's\nsummary(data)\nna.df <- data[is.na(data$steps),]\n# now backfill NA's with mean of by_interval.df\ninterval2steps <- function(interval) {\n  by_interval.summary[by_interval.summary$interval==interval,]$mean.steps\n}\nbackfill_na <- function(interval) {\n  na.df[na.df$interval==interval,]$steps <<- interval2steps(interval)\n  0\n}\nintervals.df <- unique(by_interval.df$interval)\n```\n\n```{r, echo=TRUE, results='hide'}\nforeach(i=1:length(intervals.df)) %do% backfill_na(intervals.df[i])\nbackfilled.df <- rbind(na.df, data.df)\n```\n```{r, echo=TRUE,results='asis'}\n# now create a table by date\nbackfilled_by_date.df <- group_by(backfilled.df, date)\nbackfilled_by_date.summary <- summarise(backfilled_by_date.df, totsteps=sum(steps),nr=length(interval))\n# plot histogram of data\nhist(backfilled_by_date.summary$totsteps,main=\"Histogram of total daily steps\",xlab=\"total daily steps\", ylab=\"count\")\n# mean and median of daily total steps\nbackfilled_all_data.summary <- summarise(backfilled_by_date.summary, mean.steps = mean(totsteps),median.steps=median(totsteps))\nbackfilled_all_data.summary\n```\n\n## Are there differences in activity patterns between weekdays and weekends?\n\nWe now analyze the famous \"couch potato\" effect in exercise activity. Do people take more steps on weekdays or weekends? On a typical weekend day, a subject covered 12201 steps versus 10255 steps on a weekday. If you look at the pattern of activity, assuming most subjects work in office settings, the graph shows a more subdued steps pattern for most of a typical weekday with a spike in the morning. The profile for the weekend is far more even. This can be seen clearly in the panel plot below.\n\n```{r, echo=TRUE,results='asis'}\n# now create dataframe for weekend/weekday activity pattern\nbackfilled_by_date.df$wend <- as.factor(ifelse(weekdays(backfilled_by_date.df$date) %in% c(\"Saturday\",\"Sunday\"), \"weekend\", \"weekday\")) \n# compute data frame with summary by interval \nwday_by_interval.df <- group_by(backfilled_by_date.df[backfilled_by_date.df$wend==\"weekday\",], interval)\nwday_by_interval.summary <- summarise(wday_by_interval.df, mean.steps=mean(steps))\nwday_by_interval.summary$wend <- as.factor(\"weekday\")\nsum(wday_by_interval.summary$mean.steps)\n\nwend_by_interval.df <- group_by(backfilled_by_date.df[backfilled_by_date.df$wend==\"weekend\",], interval)\nwend_by_interval.summary <- summarise(wend_by_interval.df, mean.steps=mean(steps))\nwend_by_interval.summary$wend <- as.factor(\"weekend\")\nsum(wend_by_interval.summary$mean.steps)\n\nactivity_by_interval.summary <- rbind(wday_by_interval.summary,wend_by_interval.summary)\n\nxyplot(mean.steps~interval|wend, data=activity_by_interval.summary, as.table=TRUE, main=\"Steps vs Interval\", ylab=\"Number of Steps\", xlab=\"Interval\", type='l')\n```\n",
    "created" : 1426434412743.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2481413950",
    "id" : "C6721B37",
    "lastKnownWriteTime" : 1426450593,
    "path" : "~/GitHub/RepData_PeerAssessment1/PA1_template.Rmd",
    "project_path" : "PA1_template.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}